# 外卖配送路径优化系统 模拟退火

## 问题定义

### 配送环境
- 市内分布多家餐厅（取餐点）
- 订单动态到达系统
- 司机需接单后进行配送
- 行驶产生距离成本

### 配送特征
- 一次配送服务n个顾客
- 每个顾客有m条可选配送路径
- 路径包含三个属性：距离、费用、时间

### 决策变量
- 每个顾客的配送路径选择

### 约束条件
- 总配送时间不超过预设时限C

## 算法简介

### 模拟退火算法（Simulated Annealing）
模拟退火算法模拟了金属冷却过程中的退火现象。

#### 基本原理：
- 在高温时，解可以自由变化（接受较差解的概率高）
- 温度降低时，解的变化逐渐“固定”（接受较差解的概率降低）
- 最终在低温时只接受更优的解

#### 核心参数：
- 初始温度: 100.0    # 开始时接受较差解的概率高
- 冷却系数: 0.95     # 控制温度下降速度
- 终止温度: 0.01     # 算法停止的温度阈值

## 算法流程

1. 初始化：设置初始温度 `initialTemp`、冷却速率 `coolingRate` 和最终温度 `finalTemp`

2. 生成初始解：随机为每个顾客选择一条路径

3. 生成邻域解：随机选择一个顾客并改变其路径

4. 计算能量函数：计算当前解的总成本和总时间，如果总时间超过时间约束，增加惩罚项

5. 接受概率判断：根据能量差和当前温度决定是否接受新解

6. 降温过程：按照冷却速率降低温度

7. 结束条件：当温度降至最终温度 `finalTemp` 时，算法结束

   ![acc4d097-97a2-4d2c-a44b-ce335a40a4ab](.\graph\acc4d097-97a2-4d2c-a44b-ce335a40a4ab.png)

   ![9bcae9bd-4d75-45e7-a8e1-94c517a5d7ad](.\graph\9bcae9bd-4d75-45e7-a8e1-94c517a5d7ad.png)

## 初始化和初始解

- 初始化：设置初始温度 `initialTemp`、冷却速率 `coolingRate` 和最终温度 `finalTemp`
- ![f82721ff-c077-4f0d-8de2-c3619240a8d6](.\graph\f82721ff-c077-4f0d-8de2-c3619240a8d6.png)
- 生成初始解：随机为每个顾客选择一条路径
- ![2ab962c8-4220-491d-a66d-eb8fbaef497f](.\graph\2ab962c8-4220-491d-a66d-eb8fbaef497f.png)

## 探索邻域解

- 生成邻域解：随机选择一个顾客并改变其路径
- ![1012ae36-c51c-4c6a-908f-68f04e38099d](.\graph\1012ae36-c51c-4c6a-908f-68f04e38099d.png)
- 计算能量函数：计算当前解的总成本和总时间，作为判断是否接受邻域解的依据之一

## 迭代更新

- 接受概率判断：根据能量差和当前温度决定是否接受新解

  ![b598aa7b-cc73-446e-8a61-325eec20ff77](.\graph\b598aa7b-cc73-446e-8a61-325eec20ff77.png)

- 降温过程：按照冷却速率降低温度

- ![8597f106-9115-49aa-9a42-97dce8c2cf5c](.\graph\8597f106-9115-49aa-9a42-97dce8c2cf5c.png)

## 运行结果

- 配送规模：10
- 初始温度100，冷却系数0.95，终止温度0.01
- ![5ac1cc09-c5c3-4561-92d6-11e06cb1873f](.\graph\5ac1cc09-c5c3-4561-92d6-11e06cb1873f.png)

## 参数探索

- 不同冷却系数：0.99 、0.95、0.80
- 冷却系数0.99
- ![feebd380-843c-4785-8458-e51b4862b9de](.\graph\feebd380-843c-4785-8458-e51b4862b9de.png)
- 冷却系数0.95
- ![309acacf-4f9c-42ac-a0b3-d8811be19bed](.\graph\309acacf-4f9c-42ac-a0b3-d8811be19bed.png)
- 冷却系数0.80
- ![3d359615-0996-46c0-923f-a592dc4bf488](.\graph\3d359615-0996-46c0-923f-a592dc4bf488.png)
- 冷却系数对于算法稳定性有较大影响，较高的冷却系数会造成较高的不稳定性，较低的冷却系数会有更高概率陷入邻域最优解，应对于实际问题选择适中的冷却系数